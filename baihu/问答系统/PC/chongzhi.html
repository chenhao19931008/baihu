<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>充值积分</title>
    <link rel="stylesheet" href="font/iconfont.css" />

    <link rel="stylesheet" href="css/global.css" />
    <link rel="stylesheet" href="css/index.css">
    <!--个人中心-->
    <link rel="stylesheet" href="css/person-content.css">
</head>
<body>

<!--头部信息-->
<div class="head-wrap">
    <div class="container head clearfix">
        <div class="left head-l">
            <span>你好，欢迎来到白狐医疗问答系统</span>
            <span class="hot-line"><i class="iconfont icon-dianhua1"></i>客服热线    &nbsp;&nbsp;  400-622-2976</span>
        </div>
        <div class="right head-r" >
            <ul class="head-r-list clearfix">

                <li><a href="javascript:;" class="blue">登录</a></li>
                <li><a href="#">|</a></li>
                <li><a href="javascript:;" class="blue">注册</a></li>
            </ul>
            <div class="current logined clearfix head-r-list">
                <a href="javascript:;" class="left signin" id="js-just-qiandao">签到</a>
                <a href="javascript:;" class="left message">
                    <i class="iconfont icon-2kaoshikouyutilabaicon"></i>消息
                    <span class="message-icon">9</span>
                </a>
                <div class="right menu-list-wrap">
                    <a href="javascript:;" class="user-pic"><img src="img/head.png" alt=""></a>
                    <ul class="menu-list">
                        <li><a href="javascript:;" class="font-sl">积分 <span class="yellow">99</span></a></li>
                        <li><a href="javascript:;">我的主页</a></li>
                        <li><a href="javascript:;">我的关注</a></li>
                        <li><a href="javascript:;">我的提问</a></li>
                        <li><a href="javascript:;">退出</a></li>
                    </ul>
                </div>
            </div>
        </div>
    </div>
</div>
<!--个人中心-->
<div class="person-content">
    <!--头部-->
    <div class="person-content-top">
        <div class="container person-content-top-in">
            <a href="javascript:;" class="left logo"><img src="img/center/logo.png" alt=""></a>
            <div class="person-content-search right">

            </div>
        </div>
    </div>
    <!--充值积分-->
    <div class="container">

            <div class="top-up-box">
                    <!--充值说明-->
                    <div class="top-up-t">
                        <span class="dot-left-top pic-dot"></span>
                        <span class="dot-left-bottom pic-dot"></span>
                        <span class="dot-right-top pic-dot"></span>
                        <span class="dot-right-bottom pic-dot"></span>
                        <ul class="top-up-t-dec">
                            <li>白狐软件不收取充值手续费</li>
                            <li>请注意保护好账户安全，以免造成不必要的麻烦</li>
                            <li>如果充值后积分没有及时到账，请和客服联系</li>
                        </ul>
                    </div>
                <!--充值金额选择-->
                <div class="top-up-choose">
                    <h2 class="choose-amount-title">选择充值金额</h2>
                    <ul class="top-up-choose-list clearfix">
                        <li class="addjifen active">
                            <span class="amount font-sl">￥0.1</span>
                            <p class="font-sl"><span class="jifen">5</span>积分</p>
                        </li>
                        <li class="addjifen">
                            <span class="amount font-sl">￥1</span>
                            <p class="font-sl"><span class="jifen">50</span>积分</p>
                        </li>
                        <li class="addjifen">
                            <span class="amount font-sl">￥5</span>
                            <p class="font-sl"><span class="jifen">250</span>积分</p>
                        </li>
                        <li class="addjifen">
                            <span class="amount font-sl">￥10</span>
                            <p class="font-sl"><span class="jifen">500</span>积分</p>
                        </li>
                        <li class="addjifen">
                            <span class="amount font-sl">￥20</span>
                            <p class="font-sl"><span class="jifen">1000</span>积分</p>
                        </li>
                        <li class="addjifen">
                            <span class="amount font-sl">￥50</span>
                            <p class="font-sl"><span class="jifen">2500</span>积分</p>
                        </li>
                        <li class="addjifen">
                            <span class="amount font-sl">￥100</span>
                            <p class="font-sl"><span class="jifen">5000</span>积分</p>
                        </li>

                        <li id="zdy-box" class="">
                            <span class="amount font-sl">￥0</span>
                            <a href="javascript:;" class="zdy-btn">自定义</a>

                        </li>

                    </ul>
                    <div class="zdy-box">
                        <div class="right clearfix">
                            <input type="text" class="" placeholder="请输入想要兑换的积分" id="rechange-inp">
                            <button class="rechange-btn">确认</button>
                        </div>

                    </div>
                    <div class="amount-jine">充值金额<span class="amount-jine-num">0.1</span> 元</div>
                    <div class="get-jifen">获得积分<span class="get-jifen-num">5</span> 积分</div>
                    <h2 class="choose-amount-title">充值接口</h2>
                    <div class="amount-type-box">
                        <a href="javascript:;" class="zfb active"></a>
                        <a href="javascript:;" class="wx"></a>
                    </div>
                    <div class="sub-order-box">
                        <button class="sub-order">提交订单</button>
                    </div>

                </div>
            </div>

    </div>

</div>
<!--签到-->
<div class="data-picker-wrap">
    <div class="data-picker-in">
        <span class="data-close"><i class="iconfont icon-guanbi"></i></span>
        <div class="data-top">
            <p>已连续签到 <strong class="blue">2</strong> 天</p>
        </div>
        <div class="claeafix data-bot">
            <div id="data-picker" class="left">
                <div style="width:320px;" id="calendar"></div>
            </div>
            <div class="left data-bot-right">
                <p>今日获得积分 <span class="blue"> 4</span></p>
                <p>当前积分 <span class="blue"> 4</span></p>
                <dl class="">
                    <dt>签到规则</dt>
                    <dd>首次签到科获得4个积分奖励</dd>
                    <dd>连续签到每天增加2个积分奖励</dd>
                    <dd>连续签到10天以上每天获得16个
                        积分奖励</dd>
                </dl>
            </div>
        </div>
    </div>

</div>
<!--footer-->
<div class="footer">
    <div class="container">
        <div class="footer-top clearfix">
            <a href="javascript:;">首页</a>
            <a href="javascript:;">公司简介</a>
            <a href="javascript:;">在线帮助</a>
            <a href="javascript:;">渠道招商</a>
            <a href="javascript:;">定制服务</a>
            <a href="javascript:;" class="border-right-none">升级计划</a>
        </div>
        <div class="footer-bot">
            <p>Copyright 2010-2015 All Rights Reserved. 苏ICP备123123123号-1（苏）医广[2012]第12-17-659号 苏卫网审（2011）174号</p>
            <p>全国统一客服电话：400-622-2972</p>
        </div>
    </div>
</div>
</body>
</html>
<script src="js/jquery-1.11.2.min.js"></script>
<script src="plug/layer/layer.js"></script>
<script src="js/globle.js"></script>
<script src="js/qiandao.js"></script>
<script>

    $(function(){

        $('.signin').on('click',function(){

            $('.data-picker-wrap').addClass('active');

            var date = new Date();

            var day = date.getDate();


            //签到
            //ajax获取日历json数据
            var signList=[{"signDay":"25"},{"signDay":"11"},{"signDay":"12"},{"signDay":"13"}];//已签到数据
            signList.push({"signDay":day});
            calUtil.init(signList);
        });


        $('.data-close').on('click',function(){

            $('.data-picker-wrap').removeClass('active');

        });

    });
    //--------------------------------------------充值

    //切换选择
    function payClass(tag){
        this.tag = tag;

        $(document).on('click',this.tag,function(){
           $(this).addClass('active').siblings().removeClass('active');

        });
    }

    var choose1 = new payClass(".top-up-choose-list .addjifen");//选择金额

    var choose2 = new payClass('.amount-type-box a');

    //获取选择的金额数

    function getChoose(parentBox,beishu){
        this.beishu = beishu || 50;//兑换积分比例默认为1:50；
        this.parentBox = parentBox || document;
        this.jine = $(this.parentBox).find('.amount').text().substring('1');//金额
        this.jifen = $(this.parentBox).find('.jifen').text();//积分
        this.showJe = $('.amount-jine .amount-jine-num');//展示金额
        this.showJf = $('.get-jifen .get-jifen-num');//展示积分
        this.reg = /^[0-9]*[1-9][0-9]*$/;
    }

    getChoose.prototype = {
            init:function(){
                $(this.showJe).text( this.jine);//初始化

                $(this.showJf).text( this.jifen);//初始化

            },
            addChoose:function(beishu){

                var rechangeInp = $('#rechange-inp'),
                    val = $.trim(rechangeInp.val());
                    var arr1 = $('.top-up-choose-list .jifen');
                    var result = [];
                    var flag;

                    function quchu(arr){
                        for(var i=0;i<arr.length;i++){
                            flag=false;
                            for(var j=0,len=result.length;j<len;j++){

                                if(arr[i]==result[j]){
                                    flag=true;
                                    return;
                                }
                            }

                            if(!flag){
                                result.push(arr[i])
                            }

                        }
                        return result;
                    }



                    if(val==""||isNaN(val)){
                        layer.msg('请输入数字');
                        rechangeInp.val("");
                        return;
                    }else{

                            if(val>10000000){
                                layer.msg('最大可输入1千万');
                                rechangeInp.val(10000000);
                                return;
                            }else if(!this.reg.test(val)){
                                layer.msg('请输入正整数');
                                rechangeInp.val("");
                                return;

                            }
                             $(this.showJe).text( val/this.beishu);
                             $(this.showJf).text( val);
                            var str = '<li class="addjifen"><span class="amount font-sl">￥'+val/this.beishu+'</span><p class="font-sl"><span class="jifen">'+val+'</span>积分</p></li>';

                             var len = quchu(arr1);
                                for(var i=0;i<len.length;i++){
                                    console.log()
                                    if(len[i].innerHTML==val){
                                        layer.msg("已经添加过了");
                                        rechangeInp.val("");
                                        $('.top-up-choose-list li').eq(i).addClass('active').siblings().removeClass('active');
                                        return;
                                    }

                                }

                            $('#zdy-box').before(str).prev().addClass('active').siblings().removeClass('active');

                             rechangeInp.val("");

                    }


            }

    };

    $(document).on('click','.top-up-choose-list .addjifen',function(){
        var getAdd = new getChoose(this,50).init();

    });

    $(document).on('click','.rechange-btn',function(){
        var getAdd = new getChoose(".addjifen",50).addChoose();

    });
    $(document).on('keyup',function(event){

        if(event.keyCode=="13"){
            var getAdd = new getChoose(".addjifen",50).addChoose();

        }
    });

    //切换显示自定义积分
    $('#zdy-box').on('click',function(){
        $(this).toggleClass('selected');
       $('.zdy-box').toggle();

    });




</script>

