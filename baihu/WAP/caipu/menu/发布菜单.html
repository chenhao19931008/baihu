<!DOCTYPE html>
<html>
<head>
	<title></title>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width">
	<script src="../assets/js/jquery-1.11.1.js"></script>
	<!--<![endif]-->
	<script src="../assets/js/amazeui.min.js"></script>
	<script src="../assets/js/app.js"></script>
	<script type="text/javascript" src="../js/style.js"></script>
	<script src="../js/jquery.star-rating-svg.js"></script>
	<script src="../layer_mobile/layer.js"></script>
	<script type="text/javascript" src="../js/webuploader.js"></script>
	<link rel="stylesheet" type="text/css" href="../css/webuploader.css">
	<link rel="stylesheet" type="text/css" href="../css/star-rating-svg.css">
	<link rel="stylesheet" href="../assets/css/amazeui.min.css" />
	<link rel="stylesheet" type="text/css" href="../css/style.css">
</head>
<body style="padding-bottom: 5rem;background-color: #fff; height: 100%;">
	<form class="pl_form" action="">
		<nav class="pl_nav">
			<div class="dq_bac">
				<a href="javascript:" onclick="self.location=document.referrer;">
					<img class="dq_back" src="../img/back.png">
				</a>
			</div><!-- 
             --><span>发布菜谱</span><!-- 
             --><div class="dq_bac">
				<input type="submit" name="" value="发布">
			</div>
		</nav>
		<section class="issue_content">
			<h4 class="issue_content_tit">菜谱名称</h4>
			<input type="text" name=""  class="cpname">
			<div id="uploader-demo">
			    <!--用来存放item-->
			    <div id="fileList" class="uploader-list">
			    	<span class="list_text">上传菜谱成品照片</span>
			    </div>
		    	<div id="filePicker">选择图片</div>
			</div>
			<h4 class="issue_content_tit">说说作品背后的故事</h4>
			<textarea class="cpstorage" maxlength="100"></textarea>
			<p class="cpcount">
				<span class="cp_s">0</span><span>/100</span>
			</p>
			<h4 class="cpcs">基本参数</h4>
			<dl class="cppf">
				<dt>难度</dt>
				<dd>
					<div class="cpnd"></div>
					<input type="hidden" name="" class="star_length">
				</dd>
			</dl>
			<dl class="cppf">
				<dt>时间</dt>
				<dd>
					<input type="text" name="" class="pr_time">
					分钟
				</dd>
			</dl>
			<div class="sc_tl">
				<h4 class="cpcs">添加食材和调料</h4>
				<div class="sc_tl_content">
					<div class="sc_tl_det zl">
						<ul class="sc_tl_ul">
							<li class="sc_tl_tit">
								<p>主料</p>
								<p>用量</p>
							</li>
							<li class="sc_tl_inp">
								<div>
									<input type="" name="" placeholder="如：五花肉">
								</div>
								<div>
									<input type="" name="" placeholder="如：500g">
								</div>
								<img class="cp_remove" src="../img/wrong2.png">
							</li>
						</ul>
					</div>
					<span class="tj_btn add_zl">
						添加主料
					</span>
				</div>

				<!-- 配料 -->
				<div class="sc_tl_content">
					<div class="sc_tl_det fl">
						<ul class="sc_tl_ul">
							<li class="sc_tl_tit">
								<p>配料</p>
								<p>用量</p>
							</li>
							<li class="sc_tl_inp">
								<div>
									<input type="" name="" placeholder="如：花椒">
								</div>
								<div>
									<input type="" name="" placeholder="如：5g">
								</div>
								<img class="cp_remove" src="../img/wrong2.png">
							</li>
						</ul>
					</div>
					<span class="tj_btn add_fl">
						添加配料
					</span>
				</div>
			</div>
			<div class="progress_container">
				<div class="issue_process">
					<h4 class="cpcs">描述过程</h4>
					<div class="cpbz">
						<h4 class="cpcs">步骤1</h4>
						<div id="uploader-demo0">
						    <!--用来存放item-->
						    <div id="fileList0" class="uploader-list">
						    	<span class="list_text">上传步骤图片</span>
						    </div>
						</div>
						<h4 class="issue_content_tit">描述一下（不要超过100字）</h4>
						<textarea class="cpstorage" maxlength="100"></textarea>
					</div>
				</div>
				<span class="tj_btn add_bz">
					添加步骤
				</span>
			</div>
			<h4 class="cpcs">描述过程</h4>
			<h4 class="issue_content_tit">分享你的独家技巧（不要超过100字）</h4>
			<textarea class="cpstorage" maxlength="100"></textarea>
			<div class="cp_kind">
				<h4 class="cpcs">菜谱分类</h4>
				<ul>
					<li>
						<span class="cp_kind1">家常菜谱</span>
					</li>
					<li>
						<span class="cp_kind2">快手菜</span>
					</li>
				</ul>
				<ul class="cp_dx">
					<li>
						<input type="radio" name="sfyc" value="1">
						<span>原创</span>
					</li>
					<li>
						<input type="radio" name="sfyc" value="0">
						<span>转载</span>
					</li>
				</ul>
			</div>
		</section>
	</form>
	<script type="text/javascript">




		addPic($("#filePicker"),$("#fileList"));
		addPic($(".uploader-list0"),$(".uploader-list0"))
		function addPic(btn,content){
			var uploader = WebUploader.create({

			    // 选完文件后，是否自动上传。
			    auto: true,

			    // swf文件路径
			    // swf: BASE_URL + '/js/Uploader.swf',

			    // 文件接收服务端。
			    server: 'http://webuploader.duapp.com/server/fileupload.php',

			    // 选择文件的按钮。可选。
			    // 内部根据当前运行是创建，可能是input元素，也可能是flash.
			    pick: btn,

			    // 只允许选择图片文件。
			    accept: {
			        title: 'Images',
			        extensions: 'gif,jpg,jpeg,bmp,png',
			        mimeTypes: 'image/*'
			    }
			});
			uploader.on( 'fileQueued', function( file ) {
			    var $li = $(
			            '<div id="' + file.id + '" class="file-item thumbnail">' +
			                '<img>' +
			                '<div class="info">' + file.name + '</div>' +
			            '</div>'
			            ),
			        $img = $li.find('img');


			    // $list为容器jQuery实例
			    content.append( $li );

			    // 创建缩略图
			    // 如果为非图片文件，可以不用调用此方法。
			    // thumbnailWidth x thumbnailHeight 为 100 x 100
			    uploader.makeThumb( file, function( error, src ) {
			        if ( error ) {
			            $img.replaceWith('<span>不能预览</span>');
			            return;
			        }

			        $img.attr( 'src', src );
			    }, 100, 100 );
			});
			// 文件上传过程中创建进度条实时显示。
			uploader.on( 'uploadProgress', function( file, percentage ) {
			    var $li = $( '#'+file.id ),
			        $percent = $li.find('.progress span');
			        $(".list_text").remove();
			        $("#fileList").css("background","#f9f9f9");

			    // 避免重复创建
			    if ( !$percent.length ) {
			        $percent = $('<p class="progress"><span></span></p>')
			                .appendTo( $li )
			                .find('span');
			    }

			    $percent.css( 'width', percentage * 100 + '%' );
			});

			// 文件上传成功，给item添加成功class, 用样式标记上传成功。
			uploader.on( 'uploadSuccess', function( file ) {
			    $( '#'+file.id ).addClass('upload-state-done');
			});

			// 文件上传失败，显示上传出错。
			uploader.on( 'uploadError', function( file ) {
			    var $li = $( '#'+file.id ),
			        $error = $li.find('div.error');

			    // 避免重复创建
			    if ( !$error.length ) {
			        $error = $('<div class="error"></div>').appendTo( $li );
			    }

			    $error.text('上传失败');
			});

			// 完成上传完了，成功或者失败，先删除进度条。
			uploader.on( 'uploadComplete', function( file ) {
			    $( '#'+file.id ).find('.progress').remove();
			});
		}

		function aa(){
			layer.open({
			    type: 1
			    ,content: '<span class="bb">bb</span>'
			    ,anim: 'up'
			    ,style: 'position:fixed; bottom:0; left:0; width: 100%; height: 200px; padding:10px 0; border:none;'
			 });
			$(".bb").click(function(){
				alert(11)
			})
		}
		aa();



		$(".cpnd").starRating({
		    starSize: 15,
		    initialRating: 0,
		    readOnly: false,
		    callback: function(currentRating, $el){
		        // make a server call here
		    }
		});
	</script>
</body>
</html>