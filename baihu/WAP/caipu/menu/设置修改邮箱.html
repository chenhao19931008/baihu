<!DOCTYPE html>
<html>
<head>
	<title></title>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width">
	<script src="../assets/js/jquery-1.11.1.js"></script>
	<!--<![endif]-->
	<script src="../assets/js/amazeui.min.js"></script>
	<script src="../assets/js/app.js"></script>
	<script type="text/javascript" src="../js/style.js"></script>
	<script src="../js/jquery.star-rating-svg.js"></script>
	<link rel="stylesheet" type="text/css" href="../css/star-rating-svg.css">
	<link rel="stylesheet" href="../assets/css/amazeui.min.css" />
	<link rel="stylesheet" type="text/css" href="../css/style.css">
</head>
<body style="padding-bottom: 5rem;background-color: #fff; height: 100%;">
	<form class="pl_form" action="">
		<nav class="pl_nav">
			<div class="dq_bac">
				<a href="javascript:" onclick="self.location=document.referrer;">
					<img class="dq_back" src="../img/back.png">
				</a>
			</div><!-- 
             --><span>账号绑定</span><!-- 
             --><div class="dq_bac">
				<input class="phone_sub" type="button" name="" value="提交">
			</div>
		</nav>
		<section class="phone_textarea">
			<ul>
				<li>
					<dl>
						<dt>邮箱号</dt>
						<dd>
							<input class="input_width phone_number" type="" name="">
						</dd>
					</dl>
				</li>
				<li>
					<dl>
						<dt>验证码</dt>
						<dd class="phone_two">
							<input class="phone_yzm" type="" name="">
							<input type="button" class="phone_require send_btn" value="获取验证码">
						</dd>
					</dl>
				</li>
			</ul>
		</section>
	</form>
</body>
<script src="../layer_mobile/layer.js"></script>
<script type="text/javascript">
    //验证函数
    function reg_phone(data) {
        if (!data) {
            // return;
            alert(data)
        }
        var phone = $.trim($(data.phone).val()),
            code = $.trim($(data.code).val()),
            reg_phone = data.reg;

        if (phone == "") {
            layer.open({
                skin: "msg",
                content: "请输入邮箱",
                time: 1
            });
            return false;
        } else if (!reg_phone.test(phone)) {
            layer.open({
                skin: "msg",
                content: "请输入正确邮箱",
                time: 1
            });
            return false;
        } else if (data.code) {
            if (code == "") {
                layer.open({
                    skin: "msg",
                    content: "请输入验证码",
                    time: 1
                });

                return false;
            }
        }

        return true;

    }



//    验证原来邮箱
    $('.phone_sub').on('click',function(){
        var bindPhone = reg_phone({
            phone: ".phone_number",
            code: ".phone_yzm",
            reg: /^[a-zA-Z0-9_-]+@[a-zA-Z0-9_-]+(\.[a-zA-Z0-9_-]+)+$/
        });
        if(!bindPhone){
            return false;
        }

    });


    $('.send_btn').on('click', function() {
        var bindPhone2 = reg_phone({
            phone: ".phone_number",
            reg: /^[a-zA-Z0-9_-]+@[a-zA-Z0-9_-]+(\.[a-zA-Z0-9_-]+)+$/
        });
        if (!bindPhone2) {
            return false;
        }
        time_down();
    });



    var time_down = function() {
        //手机验证倒计时
        var timer = null; //timer变量，控制时间
        var count = 60; //间隔函数，1秒执行
        var curCount = 0; //当前剩余秒数
        var code = ""; //验证码
        var codeLength = 6; //验证码长度

        function sendMessage() {



            curCount = count;

            //设置button效果，开始计时
            $(".phone_require").attr("disabled", "true");
            $(".phone_require").val(curCount + "s");
            $(".phone_require").addClass('active');
            timer = window.setInterval(SetRemainTime, 1000); //启动计时器，1秒执行一次
            SetRemainTime();


        }
        //timer处理函数
        function SetRemainTime() {
            if (curCount == 0) {
                window.clearInterval(timer); //停止计时器
                $(".phone_require").removeAttr("disabled"); //启用按钮
                $(".phone_require").removeClass('active');
                $(".phone_require").val("重新发送");

                // code = ""; //清除验证码。如果不清除，过时间后，输入收到的验证码依然有效
            } else {
                curCount--;
                $(".phone_require").val(curCount + "s");
            }
        }



        return sendMessage();

    }
</script>
</html>